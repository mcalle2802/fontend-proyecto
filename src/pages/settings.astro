---
import BaseLayout from "../layouts/BaseLayout.astro";
---

<BaseLayout title="Oracle - System Settings">
  <section class="settings-section">
    <h1>‚öôÔ∏è System Settings</h1>
    <p>Here lies the power to rewrite the fate of the system itself.</p>

    <div class="settings-grid">
      <div class="setting-card">
        <h3>üîÑ System Control</h3>
        <button id="resetBtn" class="btn danger">Reset The Cycle</button>
        <button id="maintenanceBtn" class="btn warning">Maintenance Mode</button>
      </div>
      
      <div class="setting-card">
        <h3>üë§ User Management</h3>
        <button id="editUserBtn" class="btn">Edit User Data</button>
        <button id="deleteUserBtn" class="btn danger">Delete User</button>
        <button id="disableUserBtn" class="btn warning">Disable User Access</button>
      </div>
      
      <div class="setting-card">
        <h3>üõ°Ô∏è Security Settings</h3>
        <button id="changePasswordBtn" class="btn">Force Password Reset</button>
        <button id="auditLogBtn" class="btn">View Audit Logs</button>
        <button id="sessionBtn" class="btn warning">Clear All Sessions</button>
      </div>
      
      <div class="setting-card">
        <h3>üìä Data Management</h3>
        <button id="backupBtn" class="btn">Create Backup</button>
        <button id="exportBtn" class="btn">Export Data</button>
        <button id="purgeBtn" class="btn danger">Purge Old Records</button>
      </div>
    </div>
    
    <div class="back-action">
      <a href="/admin" class="btn">Back to Oracle's Chamber</a>
    </div>
  </section>

  <script>
    document.addEventListener("DOMContentLoaded", () => {
      const role = localStorage.getItem("userRole");
      if (role !== "master") {
        alert("Access denied. Only the Oracle may alter system fate.");
        window.location.href = "/login";
        return;
      }

      // System Control
      document.getElementById("resetBtn").addEventListener("click", async () => {
        if (!confirm("‚ö†Ô∏è Are you sure you want to reset the entire cycle?")) return;
        alert("System cycle successfully reset.");
      });

      document.getElementById("maintenanceBtn").addEventListener("click", () => {
        if (confirm("Enable maintenance mode? This will block all user access.")) {
          alert("üîß Maintenance mode activated.");
        }
      });

      // User Management
      document.getElementById("editUserBtn").addEventListener("click", () => {
        const userId = prompt("Enter User ID to edit:");
        if (userId) alert(`‚úèÔ∏è Opening edit form for user ${userId}`);
      });

      document.getElementById("deleteUserBtn").addEventListener("click", () => {
        const userId = prompt("Enter User ID to delete:");
        if (userId && confirm(`Delete user ${userId}? This cannot be undone.`)) {
          alert(`üóëÔ∏è User ${userId} deleted successfully.`);
        }
      });

      document.getElementById("disableUserBtn").addEventListener("click", () => {
        const userId = prompt("Enter User ID to disable:");
        if (userId) alert(`üö´ User ${userId} access disabled.`);
      });

      // Security Settings
      document.getElementById("changePasswordBtn").addEventListener("click", () => {
        const userId = prompt("Enter User ID for password reset:");
        if (userId) alert(`üîë Password reset email sent to user ${userId}.`);
      });

      document.getElementById("auditLogBtn").addEventListener("click", () => {
        alert("üìÑ Opening audit logs viewer...");
      });

      document.getElementById("sessionBtn").addEventListener("click", () => {
        if (confirm("Clear all active user sessions? Users will need to login again.")) {
          alert("üì¥ All sessions cleared successfully.");
        }
      });

      // Data Management
      document.getElementById("backupBtn").addEventListener("click", () => {
        alert("üíæ Creating system backup... This may take a few minutes.");
      });

      document.getElementById("exportBtn").addEventListener("click", () => {
        alert("üì§ Exporting data to CSV format...");
      });

      document.getElementById("purgeBtn").addEventListener("click", () => {
        if (confirm("Purge records older than 30 days? This cannot be undone.")) {
          alert("üóëÔ∏è Old records purged successfully.");
        }
      });
    });
  </script>

  <style>
    .settings-section {
      text-align: center;
      color: #ffae42;
      padding: 3rem 1rem;
      font-family: 'Cinzel', serif;
    }

    .settings-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 2rem;
      margin: 2rem 0;
    }

    .setting-card {
      background: rgba(255, 165, 0, 0.05);
      border: 1px solid #ffae42;
      border-radius: 12px;
      padding: 1.5rem;
      text-align: center;
    }

    .setting-card h3 {
      margin-bottom: 1rem;
      color: #ffae42;
      font-size: 1.2rem;
    }

    .btn {
      background: rgba(255, 165, 0, 0.1);
      border: 1px solid #ffae42;
      padding: 0.6rem 1.2rem;
      border-radius: 6px;
      color: #ffae42;
      cursor: pointer;
      transition: background 0.3s, transform 0.2s;
      font-family: 'Cinzel', serif;
      margin: 0.3rem;
      font-size: 0.9rem;
    }

    .btn:hover {
      background: rgba(255, 165, 0, 0.3);
      transform: scale(1.05);
    }

    .btn.danger {
      border-color: #ff6666;
      color: #ff6666;
    }

    .btn.danger:hover {
      background: rgba(255, 60, 60, 0.3);
    }

    .btn.warning {
      border-color: #ffcc00;
      color: #ffcc00;
    }

    .btn.warning:hover {
      background: rgba(255, 204, 0, 0.3);
    }

    .back-action {
      text-align: center;
      margin-top: 2rem;
    }

    a.btn {
      text-decoration: none;
    }
  </style>
</BaseLayout>
